
#Proyecto final de Ciencia de Datos
#Predicción de stock market prices del sector energético internacional y su relación con la inflación no subyacente mexicana

#Luis Alvarado
#Karina Pérez
#Fedra Pineda

#Para descargar la base de datos es necesario usar la API de Yahoo Finance 
#para eso se debe usar el comando "pip install yfinance" s—lo una vez.

#pip install yfinance

import numpy as np
import yfinance as yf
import pandas as pd

#inflación no subyacente
inf_nsub = pd.read_csv ('Inflación_nosubyacente_anual.csv')

inf_nsub = inf_nsub.loc[326:466,]

#stock market prices
tickers= list(("REP.MC", "ELE.MC", "IBE.MC", "ENG.MC", "REE.MC", "ABG.MC", "PBR", "GAZP.ME", "XOM", "CVX", "PTR"))
empresas= yf.download(tickers,period="1m", start= "2005-01-01", end= "2021-12-01")

cierre= pd.DataFrame(empresas.dropna(thresh=0, axis= 1)["Close"]).dropna()

cierre.index.names= ["Fecha"]
#Datos mensuales
cierre= cierre.resample("M").mean()
